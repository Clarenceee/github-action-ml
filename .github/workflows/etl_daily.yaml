name: etl_daily # Name of the action that will appear in the "Actions" tab

# (Optional) run_name : 

on: # Trigger on the workflow 
  # schedule:
  #   - cron: '0 0 * * *' # Execute at 12am everyday
  push:
    branches: ['main']

  workflow_dispatch: # Allows the workflow to be manually triggered from the GitHub Actions tab.

jobs:
  start-mlflow-server:
    runs-on: ubuntu-latest
    
    steps: 
      - name: Access the repo
        uses: actions/checkout@v4

      - name: Configure Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10.5'

      - name: Install necessary libraries
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt
          
      - name: Set dagshub environments
        run: |
          set MLFLOW_TRACKIN_URI=https://dagshub.com/Clarenceee/github-action-ml.mlflow
          set MLFLOW_TRACKING_USERNAME=Clarenceee
          set MLFLOW_TRACKING_PASSWORD=f3874a38d72fbe0ff4ff316dba160cb01cce861f
          
      - name: Execute Mlflow Test Connection
        run: 
          python test_mlflow.py   
      

      
  # etl: # Define a job name
  #   needs: start-mlflow-server
  #   runs-on: windows-latest # Choosing GitHub hosted runners
  #   # needs: xxx # If requires dependency on other jobs
  #   steps:
  #     - name: Access the repo
  #       uses: actions/checkout@v4

  #     - name: Configure Python
  #       uses: actions/setup-python@v5
  #       with:
  #         python-version: '3.10.5'

  #     - name: Install necessary libraries
  #       run: |
  #         python -m pip install --upgrade pip
  #         pip install -r requirements.txt

  #     - name: Execute Python Scripts
  #       env:
  #         URI: ${{ secrets.URI }}
  #       run: 
  #         python etl_daily.py   

  #     - name: Upload data folder
  #       uses: actions/upload-artifact@v4
  #       with:
  #         name: data-files
  #         path: data/

  #     - name: Commit artifact
  #       uses: stefanzweifel/git-auto-commit-action@v4
  #       with:
  #         commit_message: Automated Change
